import{j as e}from"./vendor-react-Di3sF8BB.js";import{b as s,u as a,c as r}from"./vendor-query-B031p5Or.js";import{C as i,n as t,B as n,i as c,s as d}from"./index-Ba4agNH_.js";import{T as l,a as o,b as x,c as m,d as h,e as j}from"./table-DVyzr3Yq.js";import{c as u,D as p,n as v}from"./vendor-icons-CX117ToW.js";import{f as y}from"./vendor-utils-BNexaxpF.js";import"./vendor-radix-6DXuBJN5.js";import"./vendor-supabase-C3HG44mJ.js";const w=()=>{const w=s(),{data:f,isLoading:g}=a({queryKey:["admin-reviews"],queryFn:async()=>{const{data:e,error:s}=await d.from("reviews").select("*, products(name_uz)").order("created_at",{ascending:!1});if(s)throw s;return e}}),N=r({mutationFn:async e=>{const{error:s}=await d.from("reviews").update({is_approved:!0}).eq("id",e);if(s)throw s},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-reviews"]}),c.success("Izoh tasdiqlandi")}}),q=r({mutationFn:async e=>{const{error:s}=await d.from("reviews").delete().eq("id",e);if(s)throw s},onSuccess:()=>{w.invalidateQueries({queryKey:["admin-reviews"]}),c.success("O'chirildi")}});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Izohlar"}),e.jsx(i,{children:e.jsx(t,{className:"p-0",children:e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(m,{children:"Sana"}),e.jsx(m,{children:"Foydalanuvchi"}),e.jsx(m,{children:"Mahsulot"}),e.jsx(m,{children:"Reyting"}),e.jsx(m,{children:"Izoh"}),e.jsx(m,{children:"Status"}),e.jsx(m,{className:"text-right",children:"Amallar"})]})}),e.jsxs(h,{children:[f?.map(s=>{return e.jsxs(x,{children:[e.jsx(j,{className:"text-sm",children:y(new Date(s.created_at||""),"dd.MM.yyyy")}),e.jsx(j,{className:"font-medium",children:s.user_name}),e.jsx(j,{children:s.products?.name_uz||"-"}),e.jsx(j,{children:(a=s.rating,e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(s=>e.jsx(v,{className:"h-4 w-4 "+(s<=a?"fill-yellow-400 text-yellow-400":"text-muted")},s))}))}),e.jsx(j,{className:"max-w-xs truncate",children:s.comment||"-"}),e.jsx(j,{children:e.jsx("span",{className:"px-2 py-1 rounded text-xs "+(s.is_approved?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:s.is_approved?"Tasdiqlangan":"Kutilmoqda"})}),e.jsxs(j,{className:"text-right",children:[!s.is_approved&&e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>N.mutate(s.id),children:e.jsx(u,{className:"h-4 w-4 text-green-600"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>q.mutate(s.id),children:e.jsx(p,{className:"h-4 w-4 text-destructive"})})]})]},s.id);var a}),g&&e.jsx(x,{children:e.jsx(j,{colSpan:7,className:"text-center py-8",children:"Yuklanmoqda..."})}),!g&&0===f?.length&&e.jsx(x,{children:e.jsx(j,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"Izohlar topilmadi"})})]})]})})})]})};export{w as default};
