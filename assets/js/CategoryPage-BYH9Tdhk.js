import{o as e,u as a,r as s,j as r,L as i}from"./vendor-react-Di3sF8BB.js";import{u as d}from"./vendor-query-B031p5Or.js";import{u as l,L as n,S as c,B as t,a as o,b as m,d as x,e as g,f as h,P as u,g as j,s as p}from"./index-Ba4agNH_.js";import{S as y,a as f,b as v,c as N,d as b}from"./select-DtVDAZoX.js";import{B as k}from"./BreadcrumbNav-LvkZYVfj.js";import{r as q}from"./vendor-icons-CX117ToW.js";import"./vendor-radix-6DXuBJN5.js";import"./vendor-utils-BNexaxpF.js";import"./vendor-supabase-C3HG44mJ.js";const w=()=>{const{slug:w}=e(),{t:_}=a(),{currentLanguage:z}=l(),[B,K]=s.useState("newest"),[$,L]=s.useState(!1),{data:S,isLoading:C}=d({queryKey:["category",w],queryFn:async()=>{const{data:e}=await p.from("categories").select("*");if(e){const a=e.find(e=>j(e.name_uz)===w||j(e.name_ru)===w||j(e.name_en)===w||e.id===w);if(a)return a}const{data:a}=await p.from("categories").select("*").eq("id",w).maybeSingle();return a},enabled:!!w}),{data:F}=d({queryKey:["all-categories"],queryFn:async()=>{const{data:e}=await p.from("categories").select("*");return e||[]}}),{data:M,isLoading:P}=d({queryKey:["category-products",S?.id,B],queryFn:async()=>{let e=p.from("products").select("*").eq("is_active",!0).eq("category_id",S?.id);switch(B){case"price_asc":e=e.order("price",{ascending:!0});break;case"price_desc":e=e.order("price",{ascending:!1});break;case"popular":e=e.order("sold_count",{ascending:!1});break;case"rating":e=e.order("rating",{ascending:!1});break;default:e=e.order("created_at",{ascending:!1})}const{data:a}=await e;return a||[]},enabled:!!S?.id}),A=(e,a)=>e[`name_${a}`]||e.name_uz,I=e=>j(e.name_uz);if(C)return r.jsx(n,{children:r.jsx("div",{className:"container py-8",children:r.jsxs("div",{className:"animate-pulse space-y-4",children:[r.jsx("div",{className:"h-8 bg-secondary rounded w-1/3"}),r.jsx("div",{className:"h-4 bg-secondary rounded w-1/2"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8",children:[...Array(8)].map((e,a)=>r.jsx("div",{className:"aspect-square bg-secondary rounded-lg"},a))})]})})});if(!S)return r.jsxs(n,{children:[r.jsx(c,{title:"Kategoriya topilmadi",noIndex:!0}),r.jsxs("div",{className:"container py-16 text-center",children:[r.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Kategoriya topilmadi"}),r.jsx("p",{className:"text-muted-foreground mb-6",children:"Kechirasiz, siz qidirayotgan kategoriya mavjud emas."}),r.jsx(i,{to:"/catalog",children:r.jsx(t,{children:"Katalogga qaytish"})})]})]});const O=A(S,z),R="https://premium-market.uz",T=I(S),V=`${O} - Premium Market`,Y=`${O} kategoriyasidagi barcha mahsulotlar. Premium Market'da eng yaxshi narxlarda xarid qiling. Tez yetkazib berish, sifat kafolati.`,D=[{name:"Bosh sahifa",url:R},{name:"Kategoriyalar",url:`${R}/catalog`},{name:O}],E=()=>r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-3",children:_("categories")}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(i,{to:"/catalog",className:"flex items-center gap-2 p-2 rounded-md hover:bg-secondary transition-colors",children:r.jsx("span",{children:"Barcha mahsulotlar"})}),F?.map(e=>r.jsx(i,{to:`/category/${I(e)}`,className:"flex items-center gap-2 p-2 rounded-md transition-colors "+(e.id===S.id?"bg-primary/10 text-primary":"hover:bg-secondary"),children:r.jsx("span",{children:A(e,z)})},e.id))]})]})});return r.jsxs(n,{children:[r.jsx(c,{title:V,description:Y,keywords:[O,"premium market","online shopping","uzbekistan","arzon narx","chegirma"],image:S.image_url,url:`${R}/category/${T}`,breadcrumbs:D}),r.jsxs("div",{className:"container py-8",children:[r.jsx(k,{items:[{name:"Kategoriyalar",url:"/catalog"},{name:O}],className:"mb-6"}),r.jsx("div",{className:"mb-8",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl md:text-4xl font-serif font-bold mb-2",children:O}),M&&r.jsxs("p",{className:"text-muted-foreground",children:[M.length," ta mahsulot topildi"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs(o,{open:$,onOpenChange:L,children:[r.jsx(m,{asChild:!0,children:r.jsxs(t,{variant:"outline",className:"md:hidden",children:[r.jsx(q,{className:"h-4 w-4 mr-2"}),_("filter")]})}),r.jsxs(x,{side:"left",children:[r.jsx(g,{children:r.jsx(h,{children:_("filter")})}),r.jsx("div",{className:"mt-6",children:r.jsx(E,{})})]})]}),r.jsxs(y,{value:B,onValueChange:K,children:[r.jsx(f,{className:"w-[180px]",children:r.jsx(v,{placeholder:_("sortBy")})}),r.jsxs(N,{children:[r.jsx(b,{value:"newest",children:"Yangi"}),r.jsx(b,{value:"popular",children:"Mashhur"}),r.jsx(b,{value:"price_asc",children:"Narx: arzon"}),r.jsx(b,{value:"price_desc",children:"Narx: qimmat"}),r.jsx(b,{value:"rating",children:"Reyting"})]})]})]})]})}),r.jsxs("div",{className:"flex gap-8",children:[r.jsx("aside",{className:"hidden md:block w-64 flex-shrink-0",children:r.jsx(E,{})}),r.jsx("div",{className:"flex-1",children:P?r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[...Array(6)].map((e,a)=>r.jsx("div",{className:"aspect-square bg-secondary animate-pulse rounded-lg"},a))}):M&&M.length>0?r.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:M.map(e=>r.jsx(u,{product:e},e.id))}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-muted-foreground mb-4",children:"Bu kategoriyada hozircha mahsulot yo'q"}),r.jsx(i,{to:"/catalog",children:r.jsx(t,{variant:"outline",children:"Barcha mahsulotlarni ko'rish"})})]})})]}),F&&F.length>1&&r.jsxs("section",{className:"mt-16",children:[r.jsx("h2",{className:"text-2xl font-serif font-bold mb-6",children:"Boshqa kategoriyalar"}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:F.filter(e=>e.id!==S.id).slice(0,6).map(e=>r.jsx(i,{to:`/category/${I(e)}`,className:"group",children:r.jsxs("div",{className:"aspect-square relative rounded-xl overflow-hidden bg-secondary",children:[e.image_url&&r.jsx("img",{src:e.image_url,alt:A(e,z),className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",loading:"lazy"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 to-transparent flex items-end p-3",children:r.jsx("span",{className:"font-medium text-sm",children:A(e,z)})})]})},e.id))})]})]})]})};export{w as default};
