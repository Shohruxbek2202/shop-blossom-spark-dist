import{j as e}from"./vendor-react-Di3sF8BB.js";import{u as s}from"./vendor-query-B031p5Or.js";import{C as r,n as a,c as t,s as n}from"./index-DztaS-sJ.js";import{T as c,a as d,b as i,c as l,d as o,e as m}from"./table-Cyg5OxQE.js";import{f as x}from"./vendor-utils-BNexaxpF.js";import"./vendor-radix-AkGGdVjm.js";import"./vendor-icons-UB6tg7n9.js";import"./vendor-supabase-CKi7xGwz.js";const j=()=>{const{data:j,isLoading:h}=s({queryKey:["admin-orders"],queryFn:async()=>{const{data:e,error:s}=await n.from("orders").select("*, products(name_uz, images)").order("created_at",{ascending:!1});if(s)throw s;return e}}),u=(s,r)=>{switch(s){case"sent":return e.jsx(t,{className:"bg-green-500",children:"API ga yuborildi ✅"});case"error":return e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(t,{variant:"destructive",children:"Xatolik ❌"}),r&&e.jsx("span",{className:"text-xs text-destructive",children:r})]});default:return e.jsx(t,{variant:"secondary",children:"Kutilmoqda"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Buyurtmalar"}),e.jsx(r,{children:e.jsx(a,{className:"p-0",children:e.jsxs(c,{children:[e.jsx(d,{children:e.jsxs(i,{children:[e.jsx(l,{children:"Sana"}),e.jsx(l,{children:"Mijoz"}),e.jsx(l,{children:"Telefon"}),e.jsx(l,{children:"Mahsulot"}),e.jsx(l,{children:"Miqdor"}),e.jsx(l,{children:"Summa"}),e.jsx(l,{children:"Status"})]})}),e.jsxs(o,{children:[j?.map(s=>e.jsxs(i,{children:[e.jsx(m,{className:"text-sm",children:x(new Date(s.created_at||""),"dd.MM.yyyy HH:mm")}),e.jsx(m,{className:"font-medium",children:s.customer_name}),e.jsx(m,{children:s.customer_phone}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.products?.images?.[0]&&e.jsx("img",{src:s.products.images[0],alt:"",className:"w-10 h-10 object-cover rounded"}),e.jsx("span",{className:"text-sm",children:s.products?.name_uz||"-"})]})}),e.jsx(m,{children:s.quantity}),e.jsxs(m,{children:[s.total_price?.toLocaleString()," so'm"]}),e.jsx(m,{children:u(s.status||"pending",s.error_message)})]},s.id)),h&&e.jsx(i,{children:e.jsx(m,{colSpan:7,className:"text-center py-8",children:"Yuklanmoqda..."})}),!h&&0===j?.length&&e.jsx(i,{children:e.jsx(m,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"Buyurtmalar topilmadi"})})]})]})})})]})};export{j as default};
